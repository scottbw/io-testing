import{r as t,h as n,H as i,g as r}from"./p-1e894e7c.js";import{n as e}from"./p-e17cc109.js";import{s as u}from"./p-58667357.js";import{i as o,t as h,a,c as s,b as c}from"./p-9c3de80e.js";function f(t,n,i){t=+t,n=+n,i=(e=arguments.length)<2?(n=t,t=0,1):e<3?1:+i;for(var r=-1,e=0|Math.max(0,Math.ceil((n-t)/i)),u=new Array(e);++r<e;)u[r]=t+r*i;return u}const l=Symbol("implicit");function M(){var t=new Map,n=[],i=[],r=l;function e(e){var u=e+"",o=t.get(u);if(!o){if(r!==l)return r;t.set(u,o=n.push(e))}return i[(o-1)%i.length]}return e.domain=function(i){if(!arguments.length)return n.slice();n=[],t=new Map;for(const r of i){const i=r+"";t.has(i)||t.set(i,n.push(r))}return e},e.range=function(t){return arguments.length?(i=Array.from(t),e):i.slice()},e.unknown=function(t){return arguments.length?(r=t,e):r},e.copy=function(){return M(n,i).unknown(r)},o.apply(e,arguments),e}function v(t){return function(n){return n<0?-Math.pow(-n,t):Math.pow(n,t)}}function d(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function p(t){return t<0?-t*t:t*t}function m(t){var n=t(c,c),i=1;function r(){return 1===i?t(c,c):.5===i?t(d,p):t(v(i),v(1/i))}return n.exponent=function(t){return arguments.length?(i=+t,r()):i},a(n)}function y(){var t=m(h());return t.copy=function(){return s(t,y()).exponent(t.exponent())},o.apply(t,arguments),t}const g=Math.PI,b=2*g,w=b-1e-6;function A(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function x(){return new A}function C(t){return function(){return t}}A.prototype=x.prototype={constructor:A,moveTo:function(t,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,n){this._+="L"+(this._x1=+t)+","+(this._y1=+n)},quadraticCurveTo:function(t,n,i,r){this._+="Q"+ +t+","+ +n+","+(this._x1=+i)+","+(this._y1=+r)},bezierCurveTo:function(t,n,i,r,e,u){this._+="C"+ +t+","+ +n+","+ +i+","+ +r+","+(this._x1=+e)+","+(this._y1=+u)},arcTo:function(t,n,i,r,e){var u=this._x1,o=this._y1,h=(i=+i)-(t=+t),a=(r=+r)-(n=+n),s=u-t,c=o-n,f=s*s+c*c;if((e=+e)<0)throw new Error("negative radius: "+e);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=n);else if(f>1e-6)if(Math.abs(c*h-a*s)>1e-6&&e){var l=i-u,M=r-o,v=h*h+a*a,d=l*l+M*M,p=Math.sqrt(v),m=Math.sqrt(f),y=e*Math.tan((g-Math.acos((v+f-d)/(2*p*m)))/2),b=y/m,w=y/p;Math.abs(b-1)>1e-6&&(this._+="L"+(t+b*s)+","+(n+b*c)),this._+="A"+e+","+e+",0,0,"+ +(c*l>s*M)+","+(this._x1=t+w*h)+","+(this._y1=n+w*a)}else this._+="L"+(this._x1=t)+","+(this._y1=n)},arc:function(t,n,i,r,e,u){t=+t,n=+n,u=!!u;var o=(i=+i)*Math.cos(r),h=i*Math.sin(r),a=t+o,s=n+h,c=1^u,f=u?r-e:e-r;if(i<0)throw new Error("negative radius: "+i);null===this._x1?this._+="M"+a+","+s:(Math.abs(this._x1-a)>1e-6||Math.abs(this._y1-s)>1e-6)&&(this._+="L"+a+","+s),i&&(f<0&&(f=f%b+b),f>w?this._+="A"+i+","+i+",0,1,"+c+","+(t-o)+","+(n-h)+"A"+i+","+i+",0,1,"+c+","+(this._x1=a)+","+(this._y1=s):f>1e-6&&(this._+="A"+i+","+i+",0,"+ +(f>=g)+","+c+","+(this._x1=t+i*Math.cos(e))+","+(this._y1=n+i*Math.sin(e))))},rect:function(t,n,i,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)+"h"+ +i+"v"+ +r+"h"+-i+"Z"},toString:function(){return this._}};var D=Math.abs,j=Math.atan2,E=Math.cos,F=Math.max,L=Math.min,B=Math.sin,S=Math.sqrt,T=Math.PI,k=T/2,z=2*T;function U(t){return t>1?0:t<-1?T:Math.acos(t)}function W(t){return t>=1?k:t<=-1?-k:Math.asin(t)}function H(t){return t.innerRadius}function I(t){return t.outerRadius}function O(t){return t.startAngle}function P(t){return t.endAngle}function R(t){return t&&t.padAngle}function Z(t,n,i,r,e,u,o,h){var a=i-t,s=r-n,c=o-e,f=h-u,l=f*a-c*s;if(!(l*l<1e-12))return[t+(l=(c*(n-u)-f*(t-e))/l)*a,n+l*s]}function _(t,n,i,r,e,u,o){var h=t-i,a=n-r,s=(o?u:-u)/S(h*h+a*a),c=s*a,f=-s*h,l=t+c,M=n+f,v=i+c,d=r+f,p=(l+v)/2,m=(M+d)/2,y=v-l,g=d-M,b=y*y+g*g,w=e-u,A=l*d-v*M,x=(g<0?-1:1)*S(F(0,w*w*b-A*A)),C=(A*g-y*x)/b,D=(-A*y-g*x)/b,j=(A*g+y*x)/b,E=(-A*y+g*x)/b,L=C-p,B=D-m,T=j-p,k=E-m;return L*L+B*B>T*T+k*k&&(C=j,D=E),{cx:C,cy:D,x01:-c,y01:-f,x11:C*(e/w-1),y11:D*(e/w-1)}}const q=class{constructor(n){t(this,n),this.dataSrc="data/air.json",this.keys="Vision,Governance and Ethics,Digital Capacity,Adaptability,Size,Innovation Capacity,Human Capital,Infrastructure,Data Availability,Data Representativess",this.colours="#AF3845,#E94A5A,#ED6F7A,#F6B7BD,#F9F081,#F7E82D,#B8AE23,#334064,#4D6095,#6680C7",this.countryName="United States of America"}countrySelected(t){t.detail&&(this.countryName=t.detail)}load(){return fetch(this.dataSrc).then(t=>t.json()).then(t=>{this.data=t})}getCountry(t){let n=this.findByMatchingProperties(this.data,{Country:t});return n?n[0]:null}findByMatchingProperties(t,n){return t.filter((function(t){return Object.keys(n).every((function(i){return t[i]===n[i]}))}))}componentWillLoad(){return this.load()}componentWillRender(){this.country=this.filter()}componentWillUpdate(){}componentDidUpdate(){this.update()}componentDidLoad(){this.chartElement=this.element.shadowRoot.getElementById("chart"),this.svg=u(this.chartElement).append("svg").attr("class","svg-container").attr("viewBox","0 0 600 500"),this.update()}filter(){let t=this.getCountry(this.countryName);if(!t||null==t)return null;let n=this.keys.split(",").map(t=>t.trim()),i=Object.entries(t).map(([t,n])=>({key:t,value:n}));return i=i.filter((function(t){return n.includes(t.key)})),i}update(){if(this.country){this.svg&&this.svg.selectAll("g")&&this.svg.selectAll("g").remove();let t=this.colours.split(",").map(t=>t.trim()),n=M().range(t).domain(this.country.map((function(t){return t.key}))),i=0,r=140,u=function t(){var n,i,r=M().unknown(void 0),e=r.domain,u=r.range,h=0,a=1,s=!1,c=0,l=0,v=.5;function d(){var t=e().length,r=a<h,o=r?a:h,M=r?h:a;n=(M-o)/Math.max(1,t-c+2*l),s&&(n=Math.floor(n)),o+=(M-o-n*(t-c))*v,i=n*(1-c),s&&(o=Math.round(o),i=Math.round(i));var d=f(t).map((function(t){return o+n*t}));return u(r?d.reverse():d)}return delete r.unknown,r.domain=function(t){return arguments.length?(e(t),d()):e()},r.range=function(t){return arguments.length?([h,a]=t,h=+h,a=+a,d()):[h,a]},r.rangeRound=function(t){return[h,a]=t,h=+h,a=+a,s=!0,d()},r.bandwidth=function(){return i},r.step=function(){return n},r.round=function(t){return arguments.length?(s=!!t,d()):s},r.padding=function(t){return arguments.length?(c=Math.min(1,l=+t),d()):c},r.paddingInner=function(t){return arguments.length?(c=Math.min(1,t),d()):c},r.paddingOuter=function(t){return arguments.length?(l=+t,d()):l},r.align=function(t){return arguments.length?(v=Math.max(0,Math.min(1,t)),d()):v},r.copy=function(){return t(e(),[h,a]).round(s).paddingInner(c).paddingOuter(l).align(v)},o.apply(d(),arguments)}().range([0,2*Math.PI]).align(0).domain(this.country.map((function(t){return t.key}))),h=function(){return y.apply(null,arguments).exponent(.5)}().range([i,r]).domain([0,100]),a=this.svg.append("g");a.attr("transform","translate(300,250)").selectAll("path").data(this.country).enter().append("path").attr("fill",(function(t){return n(t.key)})).attr("d",function(){var t=H,n=I,i=C(0),r=null,e=O,u=P,o=R,h=null;function a(){var a,s,c=+t.apply(this,arguments),f=+n.apply(this,arguments),l=e.apply(this,arguments)-k,M=u.apply(this,arguments)-k,v=D(M-l),d=M>l;if(h||(h=a=x()),f<c&&(s=f,f=c,c=s),f>1e-12)if(v>z-1e-12)h.moveTo(f*E(l),f*B(l)),h.arc(0,0,f,l,M,!d),c>1e-12&&(h.moveTo(c*E(M),c*B(M)),h.arc(0,0,c,M,l,d));else{var p,m,y=l,g=M,b=l,w=M,A=v,C=v,F=o.apply(this,arguments)/2,H=F>1e-12&&(r?+r.apply(this,arguments):S(c*c+f*f)),I=L(D(f-c)/2,+i.apply(this,arguments)),O=I,P=I;if(H>1e-12){var R=W(H/c*B(F)),q=W(H/f*B(F));(A-=2*R)>1e-12?(b+=R*=d?1:-1,w-=R):(A=0,b=w=(l+M)/2),(C-=2*q)>1e-12?(y+=q*=d?1:-1,g-=q):(C=0,y=g=(l+M)/2)}var G=f*E(y),Q=f*B(y),V=c*E(w),J=c*B(w);if(I>1e-12){var K,N=f*E(g),X=f*B(g),Y=c*E(b),$=c*B(b);if(v<T&&(K=Z(G,Q,Y,$,N,X,V,J))){var tt=G-K[0],nt=Q-K[1],it=N-K[0],rt=X-K[1],et=1/B(U((tt*it+nt*rt)/(S(tt*tt+nt*nt)*S(it*it+rt*rt)))/2),ut=S(K[0]*K[0]+K[1]*K[1]);O=L(I,(c-ut)/(et-1)),P=L(I,(f-ut)/(et+1))}}C>1e-12?P>1e-12?(p=_(Y,$,G,Q,f,P,d),m=_(N,X,V,J,f,P,d),h.moveTo(p.cx+p.x01,p.cy+p.y01),P<I?h.arc(p.cx,p.cy,P,j(p.y01,p.x01),j(m.y01,m.x01),!d):(h.arc(p.cx,p.cy,P,j(p.y01,p.x01),j(p.y11,p.x11),!d),h.arc(0,0,f,j(p.cy+p.y11,p.cx+p.x11),j(m.cy+m.y11,m.cx+m.x11),!d),h.arc(m.cx,m.cy,P,j(m.y11,m.x11),j(m.y01,m.x01),!d))):(h.moveTo(G,Q),h.arc(0,0,f,y,g,!d)):h.moveTo(G,Q),c>1e-12&&A>1e-12?O>1e-12?(p=_(V,J,N,X,c,-O,d),m=_(G,Q,Y,$,c,-O,d),h.lineTo(p.cx+p.x01,p.cy+p.y01),O<I?h.arc(p.cx,p.cy,O,j(p.y01,p.x01),j(m.y01,m.x01),!d):(h.arc(p.cx,p.cy,O,j(p.y01,p.x01),j(p.y11,p.x11),!d),h.arc(0,0,c,j(p.cy+p.y11,p.cx+p.x11),j(m.cy+m.y11,m.cx+m.x11),d),h.arc(m.cx,m.cy,O,j(m.y11,m.x11),j(m.y01,m.x01),!d))):h.arc(0,0,c,w,b,d):h.lineTo(V,J)}else h.moveTo(0,0);if(h.closePath(),a)return h=null,a+""||null}return a.centroid=function(){var i=(+t.apply(this,arguments)+ +n.apply(this,arguments))/2,r=(+e.apply(this,arguments)+ +u.apply(this,arguments))/2-T/2;return[E(r)*i,B(r)*i]},a.innerRadius=function(n){return arguments.length?(t="function"==typeof n?n:C(+n),a):t},a.outerRadius=function(t){return arguments.length?(n="function"==typeof t?t:C(+t),a):n},a.cornerRadius=function(t){return arguments.length?(i="function"==typeof t?t:C(+t),a):i},a.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:C(+t),a):r},a.startAngle=function(t){return arguments.length?(e="function"==typeof t?t:C(+t),a):e},a.endAngle=function(t){return arguments.length?(u="function"==typeof t?t:C(+t),a):u},a.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:C(+t),a):o},a.context=function(t){return arguments.length?(h=null==t?null:t,a):h},a}().innerRadius(i).outerRadius((function(t){return h(e(t.value,2))})).startAngle((function(t){return u(t.key)})).endAngle((function(t){return u(t.key)+u.bandwidth()})).padAngle(.001).padRadius(i)),a.selectAll("g").data(this.country).enter().append("g").attr("tabindex",0).attr("text-anchor",(function(t){return(u(t.key)+u.bandwidth()/2+Math.PI)%(2*Math.PI)<Math.PI?"end":"start"})).attr("transform",(function(t){return"rotate("+(180*(u(t.key)+u.bandwidth()/2)/Math.PI-90)+")translate("+(h(t.value)+10)+",0)"})).append("text").text((function(t){return t.key+" "+e(t.value,2)})).attr("transform",(function(t){return(u(t.key)+u.bandwidth()/2+Math.PI)%(2*Math.PI)<Math.PI?"rotate("+(180-(180*(u(t.key)+u.bandwidth()/2)/Math.PI-90)-180).toString()+")":"rotate("+(0-(180*(u(t.key)+u.bandwidth()/2)/Math.PI-90)-0).toString()+")"})).attr("class","label").attr("alignment-baseline","middle")}}render(){return this.country?n(i,null,n("div",{id:"chart",tabindex:"0"}),n("slot",null)):n(i,null)}get element(){return r(this)}};q.style=":host{display:block;align-items:center;width:100%}.label{font-size:0.8rem;font-weight:bold}path:hover{stroke-width:1px;stroke:white}.chart{width:100%}:focus{outline:none;text-decoration:underline}";export{q as oi_radial_barchart}