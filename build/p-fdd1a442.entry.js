import{r as t,h as n,H as i,g as r}from"./p-1e894e7c.js";import{n as e}from"./p-b590e03c.js";import{s as u}from"./p-58667357.js";import{i as h,l as s}from"./p-a530c2d5.js";function o(t,n,i){t=+t,n=+n,i=(e=arguments.length)<2?(n=t,t=0,1):e<3?1:+i;for(var r=-1,e=0|Math.max(0,Math.ceil((n-t)/i)),u=new Array(e);++r<e;)u[r]=t+r*i;return u}const a=Symbol("implicit");function c(){var t=new Map,n=[],i=[],r=a;function e(e){var u=e+"",h=t.get(u);if(!h){if(r!==a)return r;t.set(u,h=n.push(e))}return i[(h-1)%i.length]}return e.domain=function(i){if(!arguments.length)return n.slice();n=[],t=new Map;for(const r of i){const i=r+"";t.has(i)||t.set(i,n.push(r))}return e},e.range=function(t){return arguments.length?(i=Array.from(t),e):i.slice()},e.unknown=function(t){return arguments.length?(r=t,e):r},e.copy=function(){return c(n,i).unknown(r)},h.apply(e,arguments),e}const f=Math.PI,l=2*f,M=l-1e-6;function p(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function d(){return new p}function v(t){return function(){return t}}p.prototype=d.prototype={constructor:p,moveTo:function(t,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,n){this._+="L"+(this._x1=+t)+","+(this._y1=+n)},quadraticCurveTo:function(t,n,i,r){this._+="Q"+ +t+","+ +n+","+(this._x1=+i)+","+(this._y1=+r)},bezierCurveTo:function(t,n,i,r,e,u){this._+="C"+ +t+","+ +n+","+ +i+","+ +r+","+(this._x1=+e)+","+(this._y1=+u)},arcTo:function(t,n,i,r,e){var u=this._x1,h=this._y1,s=(i=+i)-(t=+t),o=(r=+r)-(n=+n),a=u-t,c=h-n,l=a*a+c*c;if((e=+e)<0)throw new Error("negative radius: "+e);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=n);else if(l>1e-6)if(Math.abs(c*s-o*a)>1e-6&&e){var M=i-u,p=r-h,d=s*s+o*o,v=M*M+p*p,m=Math.sqrt(d),y=Math.sqrt(l),g=e*Math.tan((f-Math.acos((d+l-v)/(2*m*y)))/2),b=g/y,D=g/m;Math.abs(b-1)>1e-6&&(this._+="L"+(t+b*a)+","+(n+b*c)),this._+="A"+e+","+e+",0,0,"+ +(c*M>a*p)+","+(this._x1=t+D*s)+","+(this._y1=n+D*o)}else this._+="L"+(this._x1=t)+","+(this._y1=n)},arc:function(t,n,i,r,e,u){t=+t,n=+n,u=!!u;var h=(i=+i)*Math.cos(r),s=i*Math.sin(r),o=t+h,a=n+s,c=1^u,p=u?r-e:e-r;if(i<0)throw new Error("negative radius: "+i);null===this._x1?this._+="M"+o+","+a:(Math.abs(this._x1-o)>1e-6||Math.abs(this._y1-a)>1e-6)&&(this._+="L"+o+","+a),i&&(p<0&&(p=p%l+l),p>M?this._+="A"+i+","+i+",0,1,"+c+","+(t-h)+","+(n-s)+"A"+i+","+i+",0,1,"+c+","+(this._x1=o)+","+(this._y1=a):p>1e-6&&(this._+="A"+i+","+i+",0,"+ +(p>=f)+","+c+","+(this._x1=t+i*Math.cos(e))+","+(this._y1=n+i*Math.sin(e))))},rect:function(t,n,i,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)+"h"+ +i+"v"+ +r+"h"+-i+"Z"},toString:function(){return this._}};var m=Math.abs,y=Math.atan2,g=Math.cos,b=Math.max,D=Math.min,A=Math.sin,w=Math.sqrt,x=Math.PI,C=x/2,j=2*x;function E(t){return t>1?0:t<-1?x:Math.acos(t)}function F(t){return t>=1?C:t<=-1?-C:Math.asin(t)}function L(t){return t.innerRadius}function k(t){return t.outerRadius}function B(t){return t.startAngle}function S(t){return t.endAngle}function T(t){return t&&t.padAngle}function z(t,n,i,r,e,u,h,s){var o=i-t,a=r-n,c=h-e,f=s-u,l=f*o-c*a;if(!(l*l<1e-12))return[t+(l=(c*(n-u)-f*(t-e))/l)*o,n+l*a]}function U(t,n,i,r,e,u,h){var s=t-i,o=n-r,a=(h?u:-u)/w(s*s+o*o),c=a*o,f=-a*s,l=t+c,M=n+f,p=i+c,d=r+f,v=(l+p)/2,m=(M+d)/2,y=p-l,g=d-M,D=y*y+g*g,A=e-u,x=l*d-p*M,C=(g<0?-1:1)*w(b(0,A*A*D-x*x)),j=(x*g-y*C)/D,E=(-x*y-g*C)/D,F=(x*g+y*C)/D,L=(-x*y+g*C)/D,k=j-v,B=E-m,S=F-v,T=L-m;return k*k+B*B>S*S+T*T&&(j=F,E=L),{cx:j,cy:E,x01:-c,y01:-f,x11:j*(e/A-1),y11:E*(e/A-1)}}const W=class{constructor(n){t(this,n),this.dataSrc="data/air.json",this.keys="Vision,Governance and Ethics,Digital Capacity,Adaptability,Size,Innovation Capacity,Human Capital,Infrastructure,Data Availability,Data Representativess",this.colours="#AF3845,#E94A5A,#ED6F7A,#F6B7BD,#F9F081,#F7E82D,#B8AE23,#334064,#4D6095,#6680C7",this.countryName="United States of America"}countrySelected(t){t.detail&&(this.countryName=t.detail)}load(){return fetch(this.dataSrc).then(t=>t.json()).then(t=>{this.data=t})}getCountry(t){let n=this.findByMatchingProperties(this.data,{Country:t});return n?n[0]:null}findByMatchingProperties(t,n){return t.filter((function(t){return Object.keys(n).every((function(i){return t[i]===n[i]}))}))}componentWillLoad(){return this.load()}componentWillRender(){this.country=this.filter()}componentWillUpdate(){}componentDidUpdate(){this.update()}componentDidLoad(){this.chartElement=this.element.shadowRoot.getElementById("chart"),this.update()}filter(){let t=this.getCountry(this.countryName);if(!t||null==t)return null;let n=this.keys.split(",").map(t=>t.trim()),i=Object.entries(t).map(([t,n])=>({key:t,value:n}));return i=i.filter((function(t){return n.includes(t.key)})),i}update(){if(!this.country)return!1;let t=!1;for(let n=0;n<this.country.length;n++)this.country[n].value&&""!=this.country[n].value&&(t=!0);if(!t)return this.svg&&this.svg.selectAll("g")&&this.svg.remove(),!1;this.svg&&this.svg.selectAll("g")?this.svg.selectAll("g").remove():this.svg=u(this.chartElement).append("svg").attr("class","svg-container").attr("viewBox","0 0 600 320");let n=this.colours.split(",").map(t=>t.trim()),i=c().range(n).domain(this.country.map((function(t){return t.key}))),r=function t(){var n,i,r=c().unknown(void 0),e=r.domain,u=r.range,s=0,a=1,f=!1,l=0,M=0,p=.5;function d(){var t=e().length,r=a<s,h=r?a:s,c=r?s:a;n=(c-h)/Math.max(1,t-l+2*M),f&&(n=Math.floor(n)),h+=(c-h-n*(t-l))*p,i=n*(1-l),f&&(h=Math.round(h),i=Math.round(i));var d=o(t).map((function(t){return h+n*t}));return u(r?d.reverse():d)}return delete r.unknown,r.domain=function(t){return arguments.length?(e(t),d()):e()},r.range=function(t){return arguments.length?([s,a]=t,s=+s,a=+a,d()):[s,a]},r.rangeRound=function(t){return[s,a]=t,s=+s,a=+a,f=!0,d()},r.bandwidth=function(){return i},r.step=function(){return n},r.round=function(t){return arguments.length?(f=!!t,d()):f},r.padding=function(t){return arguments.length?(l=Math.min(1,M=+t),d()):l},r.paddingInner=function(t){return arguments.length?(l=Math.min(1,t),d()):l},r.paddingOuter=function(t){return arguments.length?(M=+t,d()):M},r.align=function(t){return arguments.length?(p=Math.max(0,Math.min(1,t)),d()):p},r.copy=function(){return t(e(),[s,a]).round(f).paddingInner(l).paddingOuter(M).align(p)},h.apply(d(),arguments)}().range([0,2*Math.PI]).align(0).domain(this.country.map((function(t){return t.key}))),a=s().range([0,140]).domain([0,100]),f=this.svg.append("g").attr("transform","translate(300,160)");for(let t=.1;t<=1;t+=.1)f.append("circle").attr("r",140*t);f.selectAll("path").data(this.country).enter().append("path").attr("fill",(function(t){return i(t.key)})).attr("d",function(){var t=L,n=k,i=v(0),r=null,e=B,u=S,h=T,s=null;function o(){var o,a,c=+t.apply(this,arguments),f=+n.apply(this,arguments),l=e.apply(this,arguments)-C,M=u.apply(this,arguments)-C,p=m(M-l),v=M>l;if(s||(s=o=d()),f<c&&(a=f,f=c,c=a),f>1e-12)if(p>j-1e-12)s.moveTo(f*g(l),f*A(l)),s.arc(0,0,f,l,M,!v),c>1e-12&&(s.moveTo(c*g(M),c*A(M)),s.arc(0,0,c,M,l,v));else{var b,L,k=l,B=M,S=l,T=M,W=p,H=p,I=h.apply(this,arguments)/2,O=I>1e-12&&(r?+r.apply(this,arguments):w(c*c+f*f)),P=D(m(f-c)/2,+i.apply(this,arguments)),R=P,Z=P;if(O>1e-12){var _=F(O/c*A(I)),q=F(O/f*A(I));(W-=2*_)>1e-12?(S+=_*=v?1:-1,T-=_):(W=0,S=T=(l+M)/2),(H-=2*q)>1e-12?(k+=q*=v?1:-1,B-=q):(H=0,k=B=(l+M)/2)}var G=f*g(k),Q=f*A(k),V=c*g(T),J=c*A(T);if(P>1e-12){var K,N=f*g(B),X=f*A(B),Y=c*g(S),$=c*A(S);if(p<x&&(K=z(G,Q,Y,$,N,X,V,J))){var tt=G-K[0],nt=Q-K[1],it=N-K[0],rt=X-K[1],et=1/A(E((tt*it+nt*rt)/(w(tt*tt+nt*nt)*w(it*it+rt*rt)))/2),ut=w(K[0]*K[0]+K[1]*K[1]);R=D(P,(c-ut)/(et-1)),Z=D(P,(f-ut)/(et+1))}}H>1e-12?Z>1e-12?(b=U(Y,$,G,Q,f,Z,v),L=U(N,X,V,J,f,Z,v),s.moveTo(b.cx+b.x01,b.cy+b.y01),Z<P?s.arc(b.cx,b.cy,Z,y(b.y01,b.x01),y(L.y01,L.x01),!v):(s.arc(b.cx,b.cy,Z,y(b.y01,b.x01),y(b.y11,b.x11),!v),s.arc(0,0,f,y(b.cy+b.y11,b.cx+b.x11),y(L.cy+L.y11,L.cx+L.x11),!v),s.arc(L.cx,L.cy,Z,y(L.y11,L.x11),y(L.y01,L.x01),!v))):(s.moveTo(G,Q),s.arc(0,0,f,k,B,!v)):s.moveTo(G,Q),c>1e-12&&W>1e-12?R>1e-12?(b=U(V,J,N,X,c,-R,v),L=U(G,Q,Y,$,c,-R,v),s.lineTo(b.cx+b.x01,b.cy+b.y01),R<P?s.arc(b.cx,b.cy,R,y(b.y01,b.x01),y(L.y01,L.x01),!v):(s.arc(b.cx,b.cy,R,y(b.y01,b.x01),y(b.y11,b.x11),!v),s.arc(0,0,c,y(b.cy+b.y11,b.cx+b.x11),y(L.cy+L.y11,L.cx+L.x11),v),s.arc(L.cx,L.cy,R,y(L.y11,L.x11),y(L.y01,L.x01),!v))):s.arc(0,0,c,T,S,v):s.lineTo(V,J)}else s.moveTo(0,0);if(s.closePath(),o)return s=null,o+""||null}return o.centroid=function(){var i=(+t.apply(this,arguments)+ +n.apply(this,arguments))/2,r=(+e.apply(this,arguments)+ +u.apply(this,arguments))/2-x/2;return[g(r)*i,A(r)*i]},o.innerRadius=function(n){return arguments.length?(t="function"==typeof n?n:v(+n),o):t},o.outerRadius=function(t){return arguments.length?(n="function"==typeof t?t:v(+t),o):n},o.cornerRadius=function(t){return arguments.length?(i="function"==typeof t?t:v(+t),o):i},o.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:v(+t),o):r},o.startAngle=function(t){return arguments.length?(e="function"==typeof t?t:v(+t),o):e},o.endAngle=function(t){return arguments.length?(u="function"==typeof t?t:v(+t),o):u},o.padAngle=function(t){return arguments.length?(h="function"==typeof t?t:v(+t),o):h},o.context=function(t){return arguments.length?(s=null==t?null:t,o):s},o}().innerRadius(0).outerRadius((function(t){return a(e(t.value,2))})).startAngle((function(t){return r(t.key)})).endAngle((function(t){return r(t.key)+r.bandwidth()})).padAngle(.001).padRadius(0)),f.selectAll("g").data(this.country).enter().append("g").attr("tabindex",0).attr("text-anchor",(function(t){return(r(t.key)+r.bandwidth()/2+Math.PI)%(2*Math.PI)<Math.PI?"end":"start"})).attr("transform",(function(t){return"rotate("+(180*(r(t.key)+r.bandwidth()/2)/Math.PI-90)+")translate(150,0)"})).append("text").text((function(t){return t.key+": "})).attr("transform",(function(t){return(r(t.key)+r.bandwidth()/2+Math.PI)%(2*Math.PI)<Math.PI?"rotate("+(180-(180*(r(t.key)+r.bandwidth()/2)/Math.PI-90)-180).toString()+")":"rotate("+(0-(180*(r(t.key)+r.bandwidth()/2)/Math.PI-90)-0).toString()+")"})).attr("class","label").attr("alignment-baseline","middle").append("tspan").attr("class","label-value").text((function(t){return e(t.value,2)})).attr("alignment-baseline","middle")}render(){return this.country?n(i,null,n("div",{id:"chart",tabindex:"0"}),n("slot",null)):n(i,null)}get element(){return r(this)}};W.style=":host{display:block;align-items:center;width:100%}.label{font-size:0.8rem}.label-value{font-weight:bold}path:hover{stroke-width:1px;stroke:white}circle{fill:none;stroke:#DDDDDD}#chart{margin:10px}:focus{outline:none;text-decoration:underline}";export{W as oi_radial_barchart}