import{r as t,h as n,H as i,g as r}from"./p-1e894e7c.js";import{n as e}from"./p-b590e03c.js";import{s as u}from"./p-58667357.js";import{i as s,l as o}from"./p-a530c2d5.js";function h(t,n,i){t=+t,n=+n,i=(e=arguments.length)<2?(n=t,t=0,1):e<3?1:+i;for(var r=-1,e=0|Math.max(0,Math.ceil((n-t)/i)),u=new Array(e);++r<e;)u[r]=t+r*i;return u}const a=Symbol("implicit");function c(){var t=new Map,n=[],i=[],r=a;function e(e){var u=e+"",s=t.get(u);if(!s){if(r!==a)return r;t.set(u,s=n.push(e))}return i[(s-1)%i.length]}return e.domain=function(i){if(!arguments.length)return n.slice();n=[],t=new Map;for(const r of i){const i=r+"";t.has(i)||t.set(i,n.push(r))}return e},e.range=function(t){return arguments.length?(i=Array.from(t),e):i.slice()},e.unknown=function(t){return arguments.length?(r=t,e):r},e.copy=function(){return c(n,i).unknown(r)},s.apply(e,arguments),e}const f=Math.PI,l=2*f,M=l-1e-6;function d(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function p(){return new d}function v(t){return function(){return t}}d.prototype=p.prototype={constructor:d,moveTo:function(t,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,n){this._+="L"+(this._x1=+t)+","+(this._y1=+n)},quadraticCurveTo:function(t,n,i,r){this._+="Q"+ +t+","+ +n+","+(this._x1=+i)+","+(this._y1=+r)},bezierCurveTo:function(t,n,i,r,e,u){this._+="C"+ +t+","+ +n+","+ +i+","+ +r+","+(this._x1=+e)+","+(this._y1=+u)},arcTo:function(t,n,i,r,e){var u=this._x1,s=this._y1,o=(i=+i)-(t=+t),h=(r=+r)-(n=+n),a=u-t,c=s-n,l=a*a+c*c;if((e=+e)<0)throw new Error("negative radius: "+e);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=n);else if(l>1e-6)if(Math.abs(c*o-h*a)>1e-6&&e){var M=i-u,d=r-s,p=o*o+h*h,v=M*M+d*d,m=Math.sqrt(p),g=Math.sqrt(l),y=e*Math.tan((f-Math.acos((p+l-v)/(2*m*g)))/2),b=y/g,D=y/m;Math.abs(b-1)>1e-6&&(this._+="L"+(t+b*a)+","+(n+b*c)),this._+="A"+e+","+e+",0,0,"+ +(c*M>a*d)+","+(this._x1=t+D*o)+","+(this._y1=n+D*h)}else this._+="L"+(this._x1=t)+","+(this._y1=n)},arc:function(t,n,i,r,e,u){t=+t,n=+n,u=!!u;var s=(i=+i)*Math.cos(r),o=i*Math.sin(r),h=t+s,a=n+o,c=1^u,d=u?r-e:e-r;if(i<0)throw new Error("negative radius: "+i);null===this._x1?this._+="M"+h+","+a:(Math.abs(this._x1-h)>1e-6||Math.abs(this._y1-a)>1e-6)&&(this._+="L"+h+","+a),i&&(d<0&&(d=d%l+l),d>M?this._+="A"+i+","+i+",0,1,"+c+","+(t-s)+","+(n-o)+"A"+i+","+i+",0,1,"+c+","+(this._x1=h)+","+(this._y1=a):d>1e-6&&(this._+="A"+i+","+i+",0,"+ +(d>=f)+","+c+","+(this._x1=t+i*Math.cos(e))+","+(this._y1=n+i*Math.sin(e))))},rect:function(t,n,i,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)+"h"+ +i+"v"+ +r+"h"+-i+"Z"},toString:function(){return this._}};var m=Math.abs,g=Math.atan2,y=Math.cos,b=Math.max,D=Math.min,A=Math.sin,w=Math.sqrt,x=Math.PI,C=x/2,j=2*x;function E(t){return t>1?0:t<-1?x:Math.acos(t)}function F(t){return t>=1?C:t<=-1?-C:Math.asin(t)}function L(t){return t.innerRadius}function k(t){return t.outerRadius}function B(t){return t.startAngle}function S(t){return t.endAngle}function T(t){return t&&t.padAngle}function z(t,n,i,r,e,u,s,o){var h=i-t,a=r-n,c=s-e,f=o-u,l=f*h-c*a;if(!(l*l<1e-12))return[t+(l=(c*(n-u)-f*(t-e))/l)*h,n+l*a]}function U(t,n,i,r,e,u,s){var o=t-i,h=n-r,a=(s?u:-u)/w(o*o+h*h),c=a*h,f=-a*o,l=t+c,M=n+f,d=i+c,p=r+f,v=(l+d)/2,m=(M+p)/2,g=d-l,y=p-M,D=g*g+y*y,A=e-u,x=l*p-d*M,C=(y<0?-1:1)*w(b(0,A*A*D-x*x)),j=(x*y-g*C)/D,E=(-x*g-y*C)/D,F=(x*y+g*C)/D,L=(-x*g+y*C)/D,k=j-v,B=E-m,S=F-v,T=L-m;return k*k+B*B>S*S+T*T&&(j=F,E=L),{cx:j,cy:E,x01:-c,y01:-f,x11:j*(e/A-1),y11:E*(e/A-1)}}const W=class{constructor(n){t(this,n),this.dataSrc="data/air.json",this.keys="Vision,Governance and Ethics,Digital Capacity,Adaptability,Size,Innovation Capacity,Human Capital,Infrastructure,Data Availability,Data Representativess",this.colours="#AF3845,#E94A5A,#ED6F7A,#F6B7BD,#F9F081,#F7E82D,#B8AE23,#334064,#4D6095,#6680C7",this.countryName="United States of America"}countrySelected(t){t.detail&&(this.countryName=t.detail)}load(){return fetch(this.dataSrc).then(t=>t.json()).then(t=>{this.data=t})}getCountry(t){let n=this.findByMatchingProperties(this.data,{Country:t});return n?n[0]:null}findByMatchingProperties(t,n){return t.filter((function(t){return Object.keys(n).every((function(i){return t[i]===n[i]}))}))}componentWillLoad(){return this.load()}componentWillRender(){this.country=this.filter()}componentWillUpdate(){}componentDidUpdate(){this.update()}componentDidLoad(){this.chartElement=this.element.shadowRoot.getElementById("chart"),this.update()}filter(){let t=this.getCountry(this.countryName);if(!t||null==t)return null;let n=this.keys.split(",").map(t=>t.trim()),i=Object.entries(t).map(([t,n])=>({key:t,value:n}));return i=i.filter((function(t){return n.includes(t.key)})),i}update(){if(!this.country)return!1;let t=!1;for(let n=0;n<this.country.length;n++)this.country[n].value&&""!=this.country[n].value&&(t=!0);if(!t)return this.svg&&this.svg.selectAll("g")&&(this.svg.remove(),this.svg=null),!1;console.log("data"),this.svg&&this.svg.selectAll("g")&&(console.log("clearing existing chart"),this.svg.selectAll("g").remove()),console.log(this.svg),this.svg||(console.log("creating svg"),this.svg=u(this.chartElement).append("svg").attr("class","svg-container").attr("viewBox","0 0 600 320"));let n=this.colours.split(",").map(t=>t.trim()),i=c().range(n).domain(this.country.map((function(t){return t.key}))),r=function t(){var n,i,r=c().unknown(void 0),e=r.domain,u=r.range,o=0,a=1,f=!1,l=0,M=0,d=.5;function p(){var t=e().length,r=a<o,s=r?a:o,c=r?o:a;n=(c-s)/Math.max(1,t-l+2*M),f&&(n=Math.floor(n)),s+=(c-s-n*(t-l))*d,i=n*(1-l),f&&(s=Math.round(s),i=Math.round(i));var p=h(t).map((function(t){return s+n*t}));return u(r?p.reverse():p)}return delete r.unknown,r.domain=function(t){return arguments.length?(e(t),p()):e()},r.range=function(t){return arguments.length?([o,a]=t,o=+o,a=+a,p()):[o,a]},r.rangeRound=function(t){return[o,a]=t,o=+o,a=+a,f=!0,p()},r.bandwidth=function(){return i},r.step=function(){return n},r.round=function(t){return arguments.length?(f=!!t,p()):f},r.padding=function(t){return arguments.length?(l=Math.min(1,M=+t),p()):l},r.paddingInner=function(t){return arguments.length?(l=Math.min(1,t),p()):l},r.paddingOuter=function(t){return arguments.length?(M=+t,p()):M},r.align=function(t){return arguments.length?(d=Math.max(0,Math.min(1,t)),p()):d},r.copy=function(){return t(e(),[o,a]).round(f).paddingInner(l).paddingOuter(M).align(d)},s.apply(p(),arguments)}().range([0,2*Math.PI]).align(0).domain(this.country.map((function(t){return t.key}))),a=o().range([0,140]).domain([0,100]),f=this.svg.append("g").attr("transform","translate(300,160)");for(let t=.1;t<=1;t+=.1)f.append("circle").attr("r",140*t);f.selectAll("path").data(this.country).enter().append("path").attr("fill",(function(t){return i(t.key)})).attr("d",function(){var t=L,n=k,i=v(0),r=null,e=B,u=S,s=T,o=null;function h(){var h,a,c=+t.apply(this,arguments),f=+n.apply(this,arguments),l=e.apply(this,arguments)-C,M=u.apply(this,arguments)-C,d=m(M-l),v=M>l;if(o||(o=h=p()),f<c&&(a=f,f=c,c=a),f>1e-12)if(d>j-1e-12)o.moveTo(f*y(l),f*A(l)),o.arc(0,0,f,l,M,!v),c>1e-12&&(o.moveTo(c*y(M),c*A(M)),o.arc(0,0,c,M,l,v));else{var b,L,k=l,B=M,S=l,T=M,W=d,H=d,I=s.apply(this,arguments)/2,O=I>1e-12&&(r?+r.apply(this,arguments):w(c*c+f*f)),P=D(m(f-c)/2,+i.apply(this,arguments)),R=P,Z=P;if(O>1e-12){var _=F(O/c*A(I)),q=F(O/f*A(I));(W-=2*_)>1e-12?(S+=_*=v?1:-1,T-=_):(W=0,S=T=(l+M)/2),(H-=2*q)>1e-12?(k+=q*=v?1:-1,B-=q):(H=0,k=B=(l+M)/2)}var G=f*y(k),Q=f*A(k),V=c*y(T),J=c*A(T);if(P>1e-12){var K,N=f*y(B),X=f*A(B),Y=c*y(S),$=c*A(S);if(d<x&&(K=z(G,Q,Y,$,N,X,V,J))){var tt=G-K[0],nt=Q-K[1],it=N-K[0],rt=X-K[1],et=1/A(E((tt*it+nt*rt)/(w(tt*tt+nt*nt)*w(it*it+rt*rt)))/2),ut=w(K[0]*K[0]+K[1]*K[1]);R=D(P,(c-ut)/(et-1)),Z=D(P,(f-ut)/(et+1))}}H>1e-12?Z>1e-12?(b=U(Y,$,G,Q,f,Z,v),L=U(N,X,V,J,f,Z,v),o.moveTo(b.cx+b.x01,b.cy+b.y01),Z<P?o.arc(b.cx,b.cy,Z,g(b.y01,b.x01),g(L.y01,L.x01),!v):(o.arc(b.cx,b.cy,Z,g(b.y01,b.x01),g(b.y11,b.x11),!v),o.arc(0,0,f,g(b.cy+b.y11,b.cx+b.x11),g(L.cy+L.y11,L.cx+L.x11),!v),o.arc(L.cx,L.cy,Z,g(L.y11,L.x11),g(L.y01,L.x01),!v))):(o.moveTo(G,Q),o.arc(0,0,f,k,B,!v)):o.moveTo(G,Q),c>1e-12&&W>1e-12?R>1e-12?(b=U(V,J,N,X,c,-R,v),L=U(G,Q,Y,$,c,-R,v),o.lineTo(b.cx+b.x01,b.cy+b.y01),R<P?o.arc(b.cx,b.cy,R,g(b.y01,b.x01),g(L.y01,L.x01),!v):(o.arc(b.cx,b.cy,R,g(b.y01,b.x01),g(b.y11,b.x11),!v),o.arc(0,0,c,g(b.cy+b.y11,b.cx+b.x11),g(L.cy+L.y11,L.cx+L.x11),v),o.arc(L.cx,L.cy,R,g(L.y11,L.x11),g(L.y01,L.x01),!v))):o.arc(0,0,c,T,S,v):o.lineTo(V,J)}else o.moveTo(0,0);if(o.closePath(),h)return o=null,h+""||null}return h.centroid=function(){var i=(+t.apply(this,arguments)+ +n.apply(this,arguments))/2,r=(+e.apply(this,arguments)+ +u.apply(this,arguments))/2-x/2;return[y(r)*i,A(r)*i]},h.innerRadius=function(n){return arguments.length?(t="function"==typeof n?n:v(+n),h):t},h.outerRadius=function(t){return arguments.length?(n="function"==typeof t?t:v(+t),h):n},h.cornerRadius=function(t){return arguments.length?(i="function"==typeof t?t:v(+t),h):i},h.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:v(+t),h):r},h.startAngle=function(t){return arguments.length?(e="function"==typeof t?t:v(+t),h):e},h.endAngle=function(t){return arguments.length?(u="function"==typeof t?t:v(+t),h):u},h.padAngle=function(t){return arguments.length?(s="function"==typeof t?t:v(+t),h):s},h.context=function(t){return arguments.length?(o=null==t?null:t,h):o},h}().innerRadius(0).outerRadius((function(t){return a(e(t.value,2))})).startAngle((function(t){return r(t.key)})).endAngle((function(t){return r(t.key)+r.bandwidth()})).padAngle(.001).padRadius(0)),f.selectAll("g").data(this.country).enter().append("g").attr("tabindex",0).attr("text-anchor",(function(t){return(r(t.key)+r.bandwidth()/2+Math.PI)%(2*Math.PI)<Math.PI?"end":"start"})).attr("transform",(function(t){return"rotate("+(180*(r(t.key)+r.bandwidth()/2)/Math.PI-90)+")translate(150,0)"})).append("text").text((function(t){return t.key+": "})).attr("transform",(function(t){return(r(t.key)+r.bandwidth()/2+Math.PI)%(2*Math.PI)<Math.PI?"rotate("+(180-(180*(r(t.key)+r.bandwidth()/2)/Math.PI-90)-180).toString()+")":"rotate("+(0-(180*(r(t.key)+r.bandwidth()/2)/Math.PI-90)-0).toString()+")"})).attr("class","label").attr("alignment-baseline","middle").append("tspan").attr("class","label-value").text((function(t){return e(t.value,2)})).attr("alignment-baseline","middle")}render(){return this.country?n(i,null,n("div",{id:"chart",tabindex:"0"}),n("slot",null)):n(i,null)}get element(){return r(this)}};W.style=":host{display:block;align-items:center;width:100%}.label{font-size:0.8rem}.label-value{font-weight:bold}path:hover{stroke-width:1px;stroke:white}circle{fill:none;stroke:#DDDDDD}#chart{margin:10px}:focus{outline:none;text-decoration:underline}";export{W as oi_radial_barchart}